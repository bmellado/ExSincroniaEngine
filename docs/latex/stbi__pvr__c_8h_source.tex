\hypertarget{stbi__pvr__c_8h_source}{}\doxysection{stbi\+\_\+pvr\+\_\+c.\+h}
\label{stbi__pvr__c_8h_source}\index{source/Rendering/SOIL2/stbi\_pvr\_c.h@{source/Rendering/SOIL2/stbi\_pvr\_c.h}}
\mbox{\hyperlink{stbi__pvr__c_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{pvr__helper_8h}{pvr\_helper.h}}"{}}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_pvr\_test(\mbox{\hyperlink{structstbi____context}{stbi\_\_context}} *s)}
\DoxyCodeLine{4 \{}
\DoxyCodeLine{5     \textcolor{comment}{//  check header size}}
\DoxyCodeLine{6     \textcolor{keywordflow}{if} (stbi\_\_get32le(s) != \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_p_v_r___texture___header}{PVR\_Texture\_Header}})) \{}
\DoxyCodeLine{7         stbi\_\_rewind(s);}
\DoxyCodeLine{8         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{9     \}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11     \textcolor{comment}{// stbi\_\_skip until the magic number}}
\DoxyCodeLine{12     stbi\_\_skip(s, 10*4);}
\DoxyCodeLine{13 }
\DoxyCodeLine{14     \textcolor{comment}{// check the magic number}}
\DoxyCodeLine{15     \textcolor{keywordflow}{if} ( stbi\_\_get32le(s) != \mbox{\hyperlink{pvr__helper_8h_a104653e6ff73a0cc635baac386e1472c}{PVRTEX\_IDENTIFIER}} ) \{}
\DoxyCodeLine{16         stbi\_\_rewind(s);}
\DoxyCodeLine{17         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{18     \}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20     \textcolor{comment}{// Also rewind because the loader needs to read the header}}
\DoxyCodeLine{21     stbi\_\_rewind(s);}
\DoxyCodeLine{22 }
\DoxyCodeLine{23     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{24 \}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keywordtype}{int}      \mbox{\hyperlink{stbi__pvr__c_8h_a505786b34fcf1751c39b53f32ab546c9}{stbi\_\_pvr\_test\_filename}}             (\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename)}
\DoxyCodeLine{29 \{}
\DoxyCodeLine{30    \textcolor{keywordtype}{int} r;}
\DoxyCodeLine{31    FILE *f = fopen(filename, \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{32    \textcolor{keywordflow}{if} (!f) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{33    r = \mbox{\hyperlink{stbi__pvr__c_8h_a71910c569cbc4ef74c9b50d6dc49793b}{stbi\_\_pvr\_test\_file}}(f);}
\DoxyCodeLine{34    fclose(f);}
\DoxyCodeLine{35    \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{36 \}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{keywordtype}{int}      \mbox{\hyperlink{stbi__pvr__c_8h_a71910c569cbc4ef74c9b50d6dc49793b}{stbi\_\_pvr\_test\_file}}        (FILE *f)}
\DoxyCodeLine{39 \{}
\DoxyCodeLine{40    \mbox{\hyperlink{structstbi____context}{stbi\_\_context}} s;}
\DoxyCodeLine{41    \textcolor{keywordtype}{int} r,n = ftell(f);}
\DoxyCodeLine{42    stbi\_\_start\_file(\&s,f);}
\DoxyCodeLine{43    r = stbi\_\_pvr\_test(\&s);}
\DoxyCodeLine{44    fseek(f,n,SEEK\_SET);}
\DoxyCodeLine{45    \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{46 \}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{keywordtype}{int}      \mbox{\hyperlink{stbi__pvr__c_8h_a36defce0395d077636963ba1d05c5e35}{stbi\_\_pvr\_test\_memory}}      (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const} *buffer, \textcolor{keywordtype}{int} len)}
\DoxyCodeLine{50 \{}
\DoxyCodeLine{51    \mbox{\hyperlink{structstbi____context}{stbi\_\_context}} s;}
\DoxyCodeLine{52    stbi\_\_start\_mem(\&s,buffer, len);}
\DoxyCodeLine{53    \textcolor{keywordflow}{return} stbi\_\_pvr\_test(\&s);}
\DoxyCodeLine{54 \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56 \textcolor{keywordtype}{int}      \mbox{\hyperlink{stbi__pvr__c_8h_aaf8f1a0b4d6ad9dbbed048cfc519a68d}{stbi\_\_pvr\_test\_callbacks}}      (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const} *clbk, \textcolor{keywordtype}{void} *user)}
\DoxyCodeLine{57 \{}
\DoxyCodeLine{58    \mbox{\hyperlink{structstbi____context}{stbi\_\_context}} s;}
\DoxyCodeLine{59    stbi\_\_start\_callbacks(\&s, (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} *) clbk, user);}
\DoxyCodeLine{60    \textcolor{keywordflow}{return} stbi\_\_pvr\_test(\&s);}
\DoxyCodeLine{61 \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_pvr\_info(\mbox{\hyperlink{structstbi____context}{stbi\_\_context}} *s, \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} * iscompressed )}
\DoxyCodeLine{64 \{}
\DoxyCodeLine{65     \mbox{\hyperlink{struct_p_v_r___texture___header}{PVR\_Texture\_Header}} header=\{0\};}
\DoxyCodeLine{66 }
\DoxyCodeLine{67     stbi\_\_getn( s, (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)(\&header), \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_p_v_r___texture___header}{PVR\_Texture\_Header}}) );}
\DoxyCodeLine{68 }
\DoxyCodeLine{69     \textcolor{comment}{// Check the header size}}
\DoxyCodeLine{70     \textcolor{keywordflow}{if} ( header.\mbox{\hyperlink{struct_p_v_r___texture___header_a1b70d66c96e4291a170028d0ba6bac0e}{dwHeaderSize}} != \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_p_v_r___texture___header}{PVR\_Texture\_Header}}) ) \{}
\DoxyCodeLine{71         stbi\_\_rewind( s );}
\DoxyCodeLine{72         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{73     \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75     \textcolor{comment}{// Check the magic identifier}}
\DoxyCodeLine{76     \textcolor{keywordflow}{if} ( header.\mbox{\hyperlink{struct_p_v_r___texture___header_a1aa3e8921cb7576374622129a952dd72}{dwPVR}} != \mbox{\hyperlink{pvr__helper_8h_a104653e6ff73a0cc635baac386e1472c}{PVRTEX\_IDENTIFIER}} ) \{}
\DoxyCodeLine{77         stbi\_\_rewind(s);}
\DoxyCodeLine{78         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{79     \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     *x = s-\/>\mbox{\hyperlink{structstbi____context_a1ef0d00dcf3fbc9ea468995b1b53fbeb}{img\_x}} = header.\mbox{\hyperlink{struct_p_v_r___texture___header_a35506d49c7fb8fe89cf2d35ec1727bdd}{dwWidth}};}
\DoxyCodeLine{82     *y = s-\/>\mbox{\hyperlink{structstbi____context_a5392767d41a587c3773d70ad2f8f33be}{img\_y}} = header.\mbox{\hyperlink{struct_p_v_r___texture___header_a5c9d7a15be622005fae8247ea1d593df}{dwHeight}};}
\DoxyCodeLine{83     *comp = s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = ( header.\mbox{\hyperlink{struct_p_v_r___texture___header_adc064257d63a00e00e131c7d93728067}{dwBitCount}} + 7 ) / 8;}
\DoxyCodeLine{84 }
\DoxyCodeLine{85     \textcolor{keywordflow}{if} ( iscompressed )}
\DoxyCodeLine{86         *iscompressed = 0;}
\DoxyCodeLine{87 }
\DoxyCodeLine{88     \textcolor{keywordflow}{switch} ( header.\mbox{\hyperlink{struct_p_v_r___texture___header_ab89dc74cf18383d2d41397e2e839faeb}{dwpfFlags}} \& \mbox{\hyperlink{pvr__helper_8h_aa112a7c808c701182cd162010bac3fe8}{PVRTEX\_PIXELTYPE}} )}
\DoxyCodeLine{89     \{}
\DoxyCodeLine{90         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da4a7dd3e4d68a93bb9f3eebbfb71f6bdf}{OGL\_RGBA\_4444}}:}
\DoxyCodeLine{91             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 2;}
\DoxyCodeLine{92             \textcolor{keywordflow}{break};}
\DoxyCodeLine{93         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da9632cdc28718895d0470ba7306b19546}{OGL\_RGBA\_5551}}:}
\DoxyCodeLine{94             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 2;}
\DoxyCodeLine{95             \textcolor{keywordflow}{break};}
\DoxyCodeLine{96         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da1f7fd9d8c860667adb5a60ea4fb2aa43}{OGL\_RGBA\_8888}}:}
\DoxyCodeLine{97             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 4;}
\DoxyCodeLine{98             \textcolor{keywordflow}{break};}
\DoxyCodeLine{99         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da4409cb1d0e3ddfa4bf4bfb8308f27632}{OGL\_RGB\_565}}:}
\DoxyCodeLine{100             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 2;}
\DoxyCodeLine{101             \textcolor{keywordflow}{break};}
\DoxyCodeLine{102         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3dae8a8e5d8c477b94fccb55da1f44ebfa5}{OGL\_RGB\_888}}:}
\DoxyCodeLine{103             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 3;}
\DoxyCodeLine{104             \textcolor{keywordflow}{break};}
\DoxyCodeLine{105         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da1bcb380c3b68d541e46ceb0cef4e3b65}{OGL\_I\_8}}:}
\DoxyCodeLine{106             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 1;}
\DoxyCodeLine{107             \textcolor{keywordflow}{break};}
\DoxyCodeLine{108         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da349513ba96fc8b71a2c116d3ebe8623e}{OGL\_AI\_88}}:}
\DoxyCodeLine{109             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 2;}
\DoxyCodeLine{110             \textcolor{keywordflow}{break};}
\DoxyCodeLine{111         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da38367577de4271e8bd818ca4e03f5722}{OGL\_PVRTC2}}:}
\DoxyCodeLine{112             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 4;}
\DoxyCodeLine{113             \textcolor{keywordflow}{if} ( iscompressed )}
\DoxyCodeLine{114                 *iscompressed = 1;}
\DoxyCodeLine{115             \textcolor{keywordflow}{break};}
\DoxyCodeLine{116         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3dad833a496a6fd87dcb555687f22c7e954}{OGL\_PVRTC4}}:}
\DoxyCodeLine{117             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 4;}
\DoxyCodeLine{118             \textcolor{keywordflow}{if} ( iscompressed )}
\DoxyCodeLine{119                 *iscompressed = 1;}
\DoxyCodeLine{120             \textcolor{keywordflow}{break};}
\DoxyCodeLine{121         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3daa01f1871147a252d5d979f98d2d37e1f}{OGL\_RGB\_555}}:}
\DoxyCodeLine{122         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{123             stbi\_\_rewind(s);}
\DoxyCodeLine{124             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{125     \}}
\DoxyCodeLine{126 }
\DoxyCodeLine{127     *comp = s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}};}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{130 \}}
\DoxyCodeLine{131 }
\DoxyCodeLine{132 \textcolor{keywordtype}{int} \mbox{\hyperlink{stbi__pvr__c_8h_a9b178bb66893f1ff2ad2fd3e88201d62}{stbi\_\_pvr\_info\_from\_memory}} (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const} *buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} * iscompressed )}
\DoxyCodeLine{133 \{}
\DoxyCodeLine{134     \mbox{\hyperlink{structstbi____context}{stbi\_\_context}} s;}
\DoxyCodeLine{135     stbi\_\_start\_mem(\&s,buffer, len);}
\DoxyCodeLine{136     \textcolor{keywordflow}{return} stbi\_\_pvr\_info( \&s, x, y, comp, iscompressed );}
\DoxyCodeLine{137 \}}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 \textcolor{keywordtype}{int} \mbox{\hyperlink{stbi__pvr__c_8h_af353311fee05a32ce6139bf167b7c9de}{stbi\_\_pvr\_info\_from\_callbacks}} (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const} *clbk, \textcolor{keywordtype}{void} *user, \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} * iscompressed)}
\DoxyCodeLine{140 \{}
\DoxyCodeLine{141     \mbox{\hyperlink{structstbi____context}{stbi\_\_context}} s;}
\DoxyCodeLine{142     stbi\_\_start\_callbacks(\&s, (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} *) clbk, user);}
\DoxyCodeLine{143     \textcolor{keywordflow}{return} stbi\_\_pvr\_info( \&s, x, y, comp, iscompressed );}
\DoxyCodeLine{144 \}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{147 \textcolor{keywordtype}{int} \mbox{\hyperlink{stbi__pvr__c_8h_a94d7a4a48f116e3b4e00a61f6012a5e1}{stbi\_\_pvr\_info\_from\_path}}(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename,     \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} * iscompressed)}
\DoxyCodeLine{148 \{}
\DoxyCodeLine{149    \textcolor{keywordtype}{int} res;}
\DoxyCodeLine{150    FILE *f = fopen(filename, \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{151    \textcolor{keywordflow}{if} (!f) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{152    res = \mbox{\hyperlink{stbi__pvr__c_8h_a4476cf404361d52bb0f38e9526136da9}{stbi\_\_pvr\_info\_from\_file}}( f, x, y, comp, iscompressed );}
\DoxyCodeLine{153    fclose(f);}
\DoxyCodeLine{154    \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{155 \}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157 \textcolor{keywordtype}{int} \mbox{\hyperlink{stbi__pvr__c_8h_a4476cf404361d52bb0f38e9526136da9}{stbi\_\_pvr\_info\_from\_file}}(FILE *f,                  \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} * iscompressed)}
\DoxyCodeLine{158 \{}
\DoxyCodeLine{159    \mbox{\hyperlink{structstbi____context}{stbi\_\_context}} s;}
\DoxyCodeLine{160    \textcolor{keywordtype}{int} res;}
\DoxyCodeLine{161    \textcolor{keywordtype}{long} n = ftell(f);}
\DoxyCodeLine{162    stbi\_\_start\_file(\&s, f);}
\DoxyCodeLine{163    res = stbi\_\_pvr\_info(\&s, x, y, comp, iscompressed);}
\DoxyCodeLine{164    fseek(f, n, SEEK\_SET);}
\DoxyCodeLine{165    \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{166 \}}
\DoxyCodeLine{167 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169 \textcolor{comment}{/******************************************************************************}}
\DoxyCodeLine{170 \textcolor{comment}{ Taken from:}}
\DoxyCodeLine{171 \textcolor{comment}{ @File         PVRTDecompress.cpp}}
\DoxyCodeLine{172 \textcolor{comment}{ @Title        PVRTDecompress}}
\DoxyCodeLine{173 \textcolor{comment}{ @Copyright    Copyright (C)  Imagination Technologies Limited.}}
\DoxyCodeLine{174 \textcolor{comment}{ @Platform     ANSI compatible}}
\DoxyCodeLine{175 \textcolor{comment}{ @Description  PVRTC Texture Decompression.}}
\DoxyCodeLine{176 \textcolor{comment}{******************************************************************************/}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}      \mbox{\hyperlink{stbi__pvr__c_8h_aa4b1278406513b20119c6d433b1d8f79}{PVRTuint8}};}
\DoxyCodeLine{179 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short}     \mbox{\hyperlink{stbi__pvr__c_8h_a0bb14023950b8fd1e7ecf2ce50145c4e}{PVRTuint16}};}
\DoxyCodeLine{180 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}       \mbox{\hyperlink{stbi__pvr__c_8h_a524aaa82e7ea31c153cfc131d5cbd7c7}{PVRTuint32}};}
\DoxyCodeLine{181 }
\DoxyCodeLine{182 \textcolor{comment}{/*****************************************************************************}}
\DoxyCodeLine{183 \textcolor{comment}{ * defines and consts}}
\DoxyCodeLine{184 \textcolor{comment}{ *****************************************************************************/}}
\DoxyCodeLine{185 \textcolor{preprocessor}{\#define PT\_INDEX (2)    }\textcolor{comment}{// The Punch-\/through index}}
\DoxyCodeLine{186 }
\DoxyCodeLine{187 \textcolor{preprocessor}{\#define BLK\_Y\_SIZE  (4) }\textcolor{comment}{// always 4 for all 2D block types}}
\DoxyCodeLine{188 }
\DoxyCodeLine{189 \textcolor{preprocessor}{\#define BLK\_X\_MAX   (8) }\textcolor{comment}{// Max X dimension for blocks}}
\DoxyCodeLine{190 }
\DoxyCodeLine{191 \textcolor{preprocessor}{\#define BLK\_X\_2BPP  (8) }\textcolor{comment}{// dimensions for the two formats}}
\DoxyCodeLine{192 \textcolor{preprocessor}{\#define BLK\_X\_4BPP  (4)}}
\DoxyCodeLine{193 }
\DoxyCodeLine{194 \textcolor{preprocessor}{\#define WRAP\_COORD(Val, Size) ((Val) \& ((Size)-\/1))}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196 \textcolor{preprocessor}{\#define POWER\_OF\_2(X)   util\_number\_is\_power\_2(X)}}
\DoxyCodeLine{197 }
\DoxyCodeLine{198 \textcolor{comment}{/*}}
\DoxyCodeLine{199 \textcolor{comment}{    Define an expression to either wrap or clamp large or small vals to the}}
\DoxyCodeLine{200 \textcolor{comment}{    legal coordinate range}}
\DoxyCodeLine{201 \textcolor{comment}{*/}}
\DoxyCodeLine{202 \textcolor{preprocessor}{\#define PVRT\_MIN(a,b)            (((a) < (b)) ? (a) : (b))}}
\DoxyCodeLine{203 \textcolor{preprocessor}{\#define PVRT\_MAX(a,b)            (((a) > (b)) ? (a) : (b))}}
\DoxyCodeLine{204 \textcolor{preprocessor}{\#define PVRT\_CLAMP(x, l, h)      (PVRT\_MIN((h), PVRT\_MAX((x), (l))))}}
\DoxyCodeLine{205 }
\DoxyCodeLine{206 \textcolor{preprocessor}{\#define LIMIT\_COORD(Val, Size, AssumeImageTiles) \(\backslash\)}}
\DoxyCodeLine{207 \textcolor{preprocessor}{      ((AssumeImageTiles)? WRAP\_COORD((Val), (Size)): PVRT\_CLAMP((Val), 0, (Size)-\/1))}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209 \textcolor{comment}{/*****************************************************************************}}
\DoxyCodeLine{210 \textcolor{comment}{ * Useful typedefs}}
\DoxyCodeLine{211 \textcolor{comment}{ *****************************************************************************/}}
\DoxyCodeLine{212 \textcolor{keyword}{typedef} \mbox{\hyperlink{stbi__pvr__c_8h_a524aaa82e7ea31c153cfc131d5cbd7c7}{PVRTuint32}} \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}};}
\DoxyCodeLine{213 \textcolor{keyword}{typedef} \mbox{\hyperlink{stbi__pvr__c_8h_aa4b1278406513b20119c6d433b1d8f79}{PVRTuint8}} \mbox{\hyperlink{stbi__pvr__c_8h_aa16003d92c76ecbe78ade9ba4e1f38e8}{U8}};}
\DoxyCodeLine{214 }
\DoxyCodeLine{215 \textcolor{comment}{/***********************************************************}}
\DoxyCodeLine{216 \textcolor{comment}{                DECOMPRESSION ROUTINES}}
\DoxyCodeLine{217 \textcolor{comment}{************************************************************/}}
\DoxyCodeLine{218 }
\DoxyCodeLine{219 \textcolor{comment}{/*!***********************************************************************}}
\DoxyCodeLine{220 \textcolor{comment}{ @Struct    AMTC\_BLOCK\_STRUCT}}
\DoxyCodeLine{221 \textcolor{comment}{ @Brief}}
\DoxyCodeLine{222 \textcolor{comment}{*************************************************************************/}}
\DoxyCodeLine{223 \textcolor{keyword}{typedef} \textcolor{keyword}{struct}}
\DoxyCodeLine{224 \{}
\DoxyCodeLine{225     \textcolor{comment}{// Uses 64 bits pre block}}
\DoxyCodeLine{226     \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} PackedData[2];}
\DoxyCodeLine{227 \}\mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t}{AMTC\_BLOCK\_STRUCT}};}
\DoxyCodeLine{228 }
\DoxyCodeLine{229  \textcolor{comment}{/*!***********************************************************************}}
\DoxyCodeLine{230 \textcolor{comment}{  @Function     util\_number\_is\_power\_2}}
\DoxyCodeLine{231 \textcolor{comment}{  @Input        input A number}}
\DoxyCodeLine{232 \textcolor{comment}{  @Returns      TRUE if the number is an integer power of two, else FALSE.}}
\DoxyCodeLine{233 \textcolor{comment}{  @Description  Check that a number is an integer power of two, i.e.}}
\DoxyCodeLine{234 \textcolor{comment}{                1, 2, 4, 8, ... etc.}}
\DoxyCodeLine{235 \textcolor{comment}{                Returns FALSE for zero.}}
\DoxyCodeLine{236 \textcolor{comment}{*************************************************************************/}}
\DoxyCodeLine{237 \textcolor{keywordtype}{int} \mbox{\hyperlink{stbi__pvr__c_8h_a6048a8011e617c263e201d5acb10088d}{util\_number\_is\_power\_2}}( \textcolor{keywordtype}{unsigned}  input )}
\DoxyCodeLine{238 \{}
\DoxyCodeLine{239   \textcolor{keywordtype}{unsigned} minus1;}
\DoxyCodeLine{240 }
\DoxyCodeLine{241   \textcolor{keywordflow}{if}( !input ) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{242 }
\DoxyCodeLine{243   minus1 = input -\/ 1;}
\DoxyCodeLine{244   \textcolor{keywordflow}{return} ( (input | minus1) == (input \string^ minus1) ) ? 1 : 0;}
\DoxyCodeLine{245 \}}
\DoxyCodeLine{246 }
\DoxyCodeLine{247 \textcolor{comment}{/*!***********************************************************************}}
\DoxyCodeLine{248 \textcolor{comment}{ @Function      Unpack5554Colour}}
\DoxyCodeLine{249 \textcolor{comment}{ @Input         pBlock}}
\DoxyCodeLine{250 \textcolor{comment}{ @Input         ABColours}}
\DoxyCodeLine{251 \textcolor{comment}{ @Description   Given a block, extract the colour information and convert}}
\DoxyCodeLine{252 \textcolor{comment}{                to 5554 formats}}
\DoxyCodeLine{253 \textcolor{comment}{*************************************************************************/}}
\DoxyCodeLine{254 \textcolor{keyword}{static} \textcolor{keywordtype}{void} Unpack5554Colour(\textcolor{keyword}{const} \mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t}{AMTC\_BLOCK\_STRUCT}} *pBlock,}
\DoxyCodeLine{255                              \textcolor{keywordtype}{int}   ABColours[2][4])}
\DoxyCodeLine{256 \{}
\DoxyCodeLine{257     \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} RawBits[2];}
\DoxyCodeLine{258 }
\DoxyCodeLine{259     \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{260 }
\DoxyCodeLine{261     \textcolor{comment}{// Extract A and B}}
\DoxyCodeLine{262     RawBits[0] = pBlock-\/>\mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t_a51e5ef3d85997dd7f886593356dd8e58}{PackedData}}[1] \& (0xFFFE); \textcolor{comment}{// 15 bits (shifted up by one)}}
\DoxyCodeLine{263     RawBits[1] = pBlock-\/>\mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t_a51e5ef3d85997dd7f886593356dd8e58}{PackedData}}[1] >> 16;    \textcolor{comment}{// 16 bits}}
\DoxyCodeLine{264 }
\DoxyCodeLine{265     \textcolor{comment}{// step through both colours}}
\DoxyCodeLine{266     \textcolor{keywordflow}{for}(i = 0; i < 2; i++)}
\DoxyCodeLine{267     \{}
\DoxyCodeLine{268         \textcolor{comment}{// If completely opaque}}
\DoxyCodeLine{269         \textcolor{keywordflow}{if}(RawBits[i] \& (1<<15))}
\DoxyCodeLine{270         \{}
\DoxyCodeLine{271             \textcolor{comment}{// Extract R and G (both 5 bit)}}
\DoxyCodeLine{272             ABColours[i][0] = (RawBits[i] >> 10) \& 0x1F;}
\DoxyCodeLine{273             ABColours[i][1] = (RawBits[i] >>  5) \& 0x1F;}
\DoxyCodeLine{274 }
\DoxyCodeLine{275             \textcolor{comment}{/*}}
\DoxyCodeLine{276 \textcolor{comment}{                The precision of Blue depends on  A or B. If A then we need to}}
\DoxyCodeLine{277 \textcolor{comment}{                replicate the top bit to get 5 bits in total}}
\DoxyCodeLine{278 \textcolor{comment}{            */}}
\DoxyCodeLine{279             ABColours[i][2] = RawBits[i] \& 0x1F;}
\DoxyCodeLine{280             \textcolor{keywordflow}{if}(i==0)}
\DoxyCodeLine{281             \{}
\DoxyCodeLine{282                 ABColours[0][2] |= ABColours[0][2] >> 4;}
\DoxyCodeLine{283             \}}
\DoxyCodeLine{284 }
\DoxyCodeLine{285             \textcolor{comment}{// set 4bit alpha fully on...}}
\DoxyCodeLine{286             ABColours[i][3] = 0xF;}
\DoxyCodeLine{287         \}}
\DoxyCodeLine{288         \textcolor{keywordflow}{else} \textcolor{comment}{// Else if colour has variable translucency}}
\DoxyCodeLine{289         \{}
\DoxyCodeLine{290             \textcolor{comment}{/*}}
\DoxyCodeLine{291 \textcolor{comment}{                Extract R and G (both 4 bit).}}
\DoxyCodeLine{292 \textcolor{comment}{                (Leave a space on the end for the replication of bits}}
\DoxyCodeLine{293 \textcolor{comment}{            */}}
\DoxyCodeLine{294             ABColours[i][0] = (RawBits[i] >>  (8-\/1)) \& 0x1E;}
\DoxyCodeLine{295             ABColours[i][1] = (RawBits[i] >>  (4-\/1)) \& 0x1E;}
\DoxyCodeLine{296 }
\DoxyCodeLine{297             \textcolor{comment}{// replicate bits to truly expand to 5 bits}}
\DoxyCodeLine{298             ABColours[i][0] |= ABColours[i][0] >> 4;}
\DoxyCodeLine{299             ABColours[i][1] |= ABColours[i][1] >> 4;}
\DoxyCodeLine{300 }
\DoxyCodeLine{301             \textcolor{comment}{// grab the 3(+padding) or 4 bits of blue and add an extra padding bit}}
\DoxyCodeLine{302             ABColours[i][2] = (RawBits[i] \& 0xF) << 1;}
\DoxyCodeLine{303 }
\DoxyCodeLine{304             \textcolor{comment}{/*}}
\DoxyCodeLine{305 \textcolor{comment}{                expand from 3 to 5 bits if this is from colour A, or 4 to 5 bits if from}}
\DoxyCodeLine{306 \textcolor{comment}{                colour B}}
\DoxyCodeLine{307 \textcolor{comment}{            */}}
\DoxyCodeLine{308             \textcolor{keywordflow}{if}(i==0)}
\DoxyCodeLine{309             \{}
\DoxyCodeLine{310                 ABColours[0][2] |= ABColours[0][2] >> 3;}
\DoxyCodeLine{311             \}}
\DoxyCodeLine{312             \textcolor{keywordflow}{else}}
\DoxyCodeLine{313             \{}
\DoxyCodeLine{314                 ABColours[0][2] |= ABColours[0][2] >> 4;}
\DoxyCodeLine{315             \}}
\DoxyCodeLine{316 }
\DoxyCodeLine{317             \textcolor{comment}{// Set the alpha bits to be 3 + a zero on the end}}
\DoxyCodeLine{318             ABColours[i][3] = (RawBits[i] >> 11) \& 0xE;}
\DoxyCodeLine{319         \}}
\DoxyCodeLine{320     \}}
\DoxyCodeLine{321 \}}
\DoxyCodeLine{322 }
\DoxyCodeLine{323 \textcolor{comment}{/*!***********************************************************************}}
\DoxyCodeLine{324 \textcolor{comment}{ @Function      UnpackModulations}}
\DoxyCodeLine{325 \textcolor{comment}{ @Input         pBlock}}
\DoxyCodeLine{326 \textcolor{comment}{ @Input         Do2bitMode}}
\DoxyCodeLine{327 \textcolor{comment}{ @Input         ModulationVals}}
\DoxyCodeLine{328 \textcolor{comment}{ @Input         ModulationModes}}
\DoxyCodeLine{329 \textcolor{comment}{ @Input         StartX}}
\DoxyCodeLine{330 \textcolor{comment}{ @Input         StartY}}
\DoxyCodeLine{331 \textcolor{comment}{ @Description   Given the block and the texture type and it's relative}}
\DoxyCodeLine{332 \textcolor{comment}{                position in the 2x2 group of blocks, extract the bit}}
\DoxyCodeLine{333 \textcolor{comment}{                patterns for the fully defined pixels.}}
\DoxyCodeLine{334 \textcolor{comment}{*************************************************************************/}}
\DoxyCodeLine{335 \textcolor{keyword}{static} \textcolor{keywordtype}{void} UnpackModulations(\textcolor{keyword}{const} \mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t}{AMTC\_BLOCK\_STRUCT}} *pBlock,}
\DoxyCodeLine{336                               \textcolor{keyword}{const} \textcolor{keywordtype}{int} Do2bitMode,}
\DoxyCodeLine{337                               \textcolor{keywordtype}{int} ModulationVals[8][16],}
\DoxyCodeLine{338                               \textcolor{keywordtype}{int} ModulationModes[8][16],}
\DoxyCodeLine{339                               \textcolor{keywordtype}{int} StartX,}
\DoxyCodeLine{340                               \textcolor{keywordtype}{int} StartY)}
\DoxyCodeLine{341 \{}
\DoxyCodeLine{342     \textcolor{keywordtype}{int} BlockModMode;}
\DoxyCodeLine{343     \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} ModulationBits;}
\DoxyCodeLine{344 }
\DoxyCodeLine{345     \textcolor{keywordtype}{int} x, y;}
\DoxyCodeLine{346 }
\DoxyCodeLine{347     BlockModMode= pBlock-\/>\mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t_a51e5ef3d85997dd7f886593356dd8e58}{PackedData}}[1] \& 1;}
\DoxyCodeLine{348     ModulationBits  = pBlock-\/>\mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t_a51e5ef3d85997dd7f886593356dd8e58}{PackedData}}[0];}
\DoxyCodeLine{349 }
\DoxyCodeLine{350     \textcolor{comment}{// if it's in an interpolated mode}}
\DoxyCodeLine{351     \textcolor{keywordflow}{if}(Do2bitMode \&\& BlockModMode)}
\DoxyCodeLine{352     \{}
\DoxyCodeLine{353         \textcolor{comment}{/*}}
\DoxyCodeLine{354 \textcolor{comment}{            run through all the pixels in the block. Note we can now treat all the}}
\DoxyCodeLine{355 \textcolor{comment}{            "{}stored"{} values as if they have 2bits (even when they didn't!)}}
\DoxyCodeLine{356 \textcolor{comment}{        */}}
\DoxyCodeLine{357         \textcolor{keywordflow}{for}(y = 0; y < \mbox{\hyperlink{stbi__pvr__c_8h_ab04e838877fc1df19927d5753108c96e}{BLK\_Y\_SIZE}}; y++)}
\DoxyCodeLine{358         \{}
\DoxyCodeLine{359             \textcolor{keywordflow}{for}(x = 0; x < \mbox{\hyperlink{stbi__pvr__c_8h_a70b6ed94c74b741311fe614a35fa7747}{BLK\_X\_2BPP}}; x++)}
\DoxyCodeLine{360             \{}
\DoxyCodeLine{361                 ModulationModes[y+StartY][x+StartX] = BlockModMode;}
\DoxyCodeLine{362 }
\DoxyCodeLine{363                 \textcolor{comment}{// if this is a stored value...}}
\DoxyCodeLine{364                 \textcolor{keywordflow}{if}(((x\string^y)\&1) == 0)}
\DoxyCodeLine{365                 \{}
\DoxyCodeLine{366                     ModulationVals[y+StartY][x+StartX] = ModulationBits \& 3;}
\DoxyCodeLine{367                     ModulationBits >>= 2;}
\DoxyCodeLine{368                 \}}
\DoxyCodeLine{369             \}}
\DoxyCodeLine{370         \}}
\DoxyCodeLine{371     \}}
\DoxyCodeLine{372     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(Do2bitMode) \textcolor{comment}{// else if direct encoded 2bit mode -\/ i.e. 1 mode bit per pixel}}
\DoxyCodeLine{373     \{}
\DoxyCodeLine{374         \textcolor{keywordflow}{for}(y = 0; y < \mbox{\hyperlink{stbi__pvr__c_8h_ab04e838877fc1df19927d5753108c96e}{BLK\_Y\_SIZE}}; y++)}
\DoxyCodeLine{375         \{}
\DoxyCodeLine{376             \textcolor{keywordflow}{for}(x = 0; x < \mbox{\hyperlink{stbi__pvr__c_8h_a70b6ed94c74b741311fe614a35fa7747}{BLK\_X\_2BPP}}; x++)}
\DoxyCodeLine{377             \{}
\DoxyCodeLine{378                 ModulationModes[y+StartY][x+StartX] = BlockModMode;}
\DoxyCodeLine{379 }
\DoxyCodeLine{380                 \textcolor{comment}{// double the bits so 0=> 00, and 1=>11}}
\DoxyCodeLine{381                 \textcolor{keywordflow}{if}(ModulationBits \& 1)}
\DoxyCodeLine{382                 \{}
\DoxyCodeLine{383                     ModulationVals[y+StartY][x+StartX] = 0x3;}
\DoxyCodeLine{384                 \}}
\DoxyCodeLine{385                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{386                 \{}
\DoxyCodeLine{387                     ModulationVals[y+StartY][x+StartX] = 0x0;}
\DoxyCodeLine{388                 \}}
\DoxyCodeLine{389                 ModulationBits >>= 1;}
\DoxyCodeLine{390             \}}
\DoxyCodeLine{391         \}}
\DoxyCodeLine{392     \}}
\DoxyCodeLine{393     \textcolor{keywordflow}{else} \textcolor{comment}{// else its the 4bpp mode so each value has 2 bits}}
\DoxyCodeLine{394     \{}
\DoxyCodeLine{395         \textcolor{keywordflow}{for}(y = 0; y < \mbox{\hyperlink{stbi__pvr__c_8h_ab04e838877fc1df19927d5753108c96e}{BLK\_Y\_SIZE}}; y++)}
\DoxyCodeLine{396         \{}
\DoxyCodeLine{397             \textcolor{keywordflow}{for}(x = 0; x < \mbox{\hyperlink{stbi__pvr__c_8h_ac1db0a9ee13763c6340b18ae5c50e728}{BLK\_X\_4BPP}}; x++)}
\DoxyCodeLine{398             \{}
\DoxyCodeLine{399                 ModulationModes[y+StartY][x+StartX] = BlockModMode;}
\DoxyCodeLine{400 }
\DoxyCodeLine{401                 ModulationVals[y+StartY][x+StartX] = ModulationBits \& 3;}
\DoxyCodeLine{402                 ModulationBits >>= 2;}
\DoxyCodeLine{403             \}}
\DoxyCodeLine{404         \}}
\DoxyCodeLine{405     \}}
\DoxyCodeLine{406 }
\DoxyCodeLine{407     \textcolor{comment}{// make sure nothing is left over}}
\DoxyCodeLine{408     assert(ModulationBits==0);}
\DoxyCodeLine{409 \}}
\DoxyCodeLine{410 }
\DoxyCodeLine{411 \textcolor{comment}{/*!***********************************************************************}}
\DoxyCodeLine{412 \textcolor{comment}{ @Function      InterpolateColours}}
\DoxyCodeLine{413 \textcolor{comment}{ @Input         ColourP}}
\DoxyCodeLine{414 \textcolor{comment}{ @Input         ColourQ}}
\DoxyCodeLine{415 \textcolor{comment}{ @Input         ColourR}}
\DoxyCodeLine{416 \textcolor{comment}{ @Input         ColourS}}
\DoxyCodeLine{417 \textcolor{comment}{ @Input         Do2bitMode}}
\DoxyCodeLine{418 \textcolor{comment}{ @Input         x}}
\DoxyCodeLine{419 \textcolor{comment}{ @Input         y}}
\DoxyCodeLine{420 \textcolor{comment}{ @Modified      Result}}
\DoxyCodeLine{421 \textcolor{comment}{ @Description   This performs a HW bit accurate interpolation of either the}}
\DoxyCodeLine{422 \textcolor{comment}{                A or B colours for a particular pixel.}}
\DoxyCodeLine{423 \textcolor{comment}{}}
\DoxyCodeLine{424 \textcolor{comment}{                NOTE: It is assumed that the source colours are in ARGB 5554}}
\DoxyCodeLine{425 \textcolor{comment}{                format -\/ This means that some "{}preparation"{} of the values will}}
\DoxyCodeLine{426 \textcolor{comment}{                be necessary.}}
\DoxyCodeLine{427 \textcolor{comment}{*************************************************************************/}}
\DoxyCodeLine{428 \textcolor{keyword}{static} \textcolor{keywordtype}{void} InterpolateColours(\textcolor{keyword}{const} \textcolor{keywordtype}{int} ColourP[4],}
\DoxyCodeLine{429                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} ColourQ[4],}
\DoxyCodeLine{430                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} ColourR[4],}
\DoxyCodeLine{431                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} ColourS[4],}
\DoxyCodeLine{432                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} Do2bitMode,}
\DoxyCodeLine{433                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} x,}
\DoxyCodeLine{434                           \textcolor{keyword}{const} \textcolor{keywordtype}{int} y,}
\DoxyCodeLine{435                           \textcolor{keywordtype}{int} Result[4])}
\DoxyCodeLine{436 \{}
\DoxyCodeLine{437     \textcolor{keywordtype}{int} u, v, uscale;}
\DoxyCodeLine{438     \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{439 }
\DoxyCodeLine{440     \textcolor{keywordtype}{int} tmp1, tmp2;}
\DoxyCodeLine{441 }
\DoxyCodeLine{442     \textcolor{keywordtype}{int} P[4], Q[4], R[4], S[4];}
\DoxyCodeLine{443 }
\DoxyCodeLine{444     \textcolor{comment}{// Copy the colours}}
\DoxyCodeLine{445     \textcolor{keywordflow}{for}(k = 0; k < 4; k++)}
\DoxyCodeLine{446     \{}
\DoxyCodeLine{447         P[k] = ColourP[k];}
\DoxyCodeLine{448         Q[k] = ColourQ[k];}
\DoxyCodeLine{449         R[k] = ColourR[k];}
\DoxyCodeLine{450         S[k] = ColourS[k];}
\DoxyCodeLine{451     \}}
\DoxyCodeLine{452 }
\DoxyCodeLine{453     \textcolor{comment}{// put the x and y values into the right range}}
\DoxyCodeLine{454     v = (y \& 0x3) | ((\string~y \& 0x2) << 1);}
\DoxyCodeLine{455 }
\DoxyCodeLine{456     \textcolor{keywordflow}{if}(Do2bitMode)}
\DoxyCodeLine{457         u = (x \& 0x7) | ((\string~x \& 0x4) << 1);}
\DoxyCodeLine{458     \textcolor{keywordflow}{else}}
\DoxyCodeLine{459         u = (x \& 0x3) | ((\string~x \& 0x2) << 1);}
\DoxyCodeLine{460 }
\DoxyCodeLine{461     \textcolor{comment}{// get the u and v scale amounts}}
\DoxyCodeLine{462     v  = v -\/ \mbox{\hyperlink{stbi__pvr__c_8h_ab04e838877fc1df19927d5753108c96e}{BLK\_Y\_SIZE}}/2;}
\DoxyCodeLine{463 }
\DoxyCodeLine{464     \textcolor{keywordflow}{if}(Do2bitMode)}
\DoxyCodeLine{465     \{}
\DoxyCodeLine{466         u = u -\/ \mbox{\hyperlink{stbi__pvr__c_8h_a70b6ed94c74b741311fe614a35fa7747}{BLK\_X\_2BPP}}/2;}
\DoxyCodeLine{467         uscale = 8;}
\DoxyCodeLine{468     \}}
\DoxyCodeLine{469     \textcolor{keywordflow}{else}}
\DoxyCodeLine{470     \{}
\DoxyCodeLine{471         u = u -\/ \mbox{\hyperlink{stbi__pvr__c_8h_ac1db0a9ee13763c6340b18ae5c50e728}{BLK\_X\_4BPP}}/2;}
\DoxyCodeLine{472         uscale = 4;}
\DoxyCodeLine{473     \}}
\DoxyCodeLine{474 }
\DoxyCodeLine{475     \textcolor{keywordflow}{for}(k = 0; k < 4; k++)}
\DoxyCodeLine{476     \{}
\DoxyCodeLine{477         tmp1 = P[k] * uscale + u * (Q[k] -\/ P[k]);}
\DoxyCodeLine{478         tmp2 = R[k] * uscale + u * (S[k] -\/ R[k]);}
\DoxyCodeLine{479 }
\DoxyCodeLine{480         tmp1 = tmp1 * 4 + v * (tmp2 -\/ tmp1);}
\DoxyCodeLine{481 }
\DoxyCodeLine{482         Result[k] = tmp1;}
\DoxyCodeLine{483     \}}
\DoxyCodeLine{484 }
\DoxyCodeLine{485     \textcolor{comment}{// Lop off the appropriate number of bits to get us to 8 bit precision}}
\DoxyCodeLine{486     \textcolor{keywordflow}{if}(Do2bitMode)}
\DoxyCodeLine{487     \{}
\DoxyCodeLine{488         \textcolor{comment}{// do RGB}}
\DoxyCodeLine{489         \textcolor{keywordflow}{for}(k = 0; k < 3; k++)}
\DoxyCodeLine{490         \{}
\DoxyCodeLine{491             Result[k] >>= 2;}
\DoxyCodeLine{492         \}}
\DoxyCodeLine{493 }
\DoxyCodeLine{494         Result[3] >>= 1;}
\DoxyCodeLine{495     \}}
\DoxyCodeLine{496     \textcolor{keywordflow}{else}}
\DoxyCodeLine{497     \{}
\DoxyCodeLine{498         \textcolor{comment}{// do RGB  (A is ok)}}
\DoxyCodeLine{499         \textcolor{keywordflow}{for}(k = 0; k < 3; k++)}
\DoxyCodeLine{500         \{}
\DoxyCodeLine{501             Result[k] >>= 1;}
\DoxyCodeLine{502         \}}
\DoxyCodeLine{503     \}}
\DoxyCodeLine{504 }
\DoxyCodeLine{505     \textcolor{comment}{// sanity check}}
\DoxyCodeLine{506     \textcolor{keywordflow}{for}(k = 0; k < 4; k++)}
\DoxyCodeLine{507     \{}
\DoxyCodeLine{508         assert(Result[k] < 256);}
\DoxyCodeLine{509     \}}
\DoxyCodeLine{510 }
\DoxyCodeLine{511 }
\DoxyCodeLine{512     \textcolor{comment}{/*}}
\DoxyCodeLine{513 \textcolor{comment}{        Convert from 5554 to 8888}}
\DoxyCodeLine{514 \textcolor{comment}{}}
\DoxyCodeLine{515 \textcolor{comment}{        do RGB 5.3 => 8}}
\DoxyCodeLine{516 \textcolor{comment}{    */}}
\DoxyCodeLine{517     \textcolor{keywordflow}{for}(k = 0; k < 3; k++)}
\DoxyCodeLine{518     \{}
\DoxyCodeLine{519         Result[k] += Result[k] >> 5;}
\DoxyCodeLine{520     \}}
\DoxyCodeLine{521 }
\DoxyCodeLine{522     Result[3] += Result[3] >> 4;}
\DoxyCodeLine{523 }
\DoxyCodeLine{524     \textcolor{comment}{// 2nd sanity check}}
\DoxyCodeLine{525     \textcolor{keywordflow}{for}(k = 0; k < 4; k++)}
\DoxyCodeLine{526     \{}
\DoxyCodeLine{527         assert(Result[k] < 256);}
\DoxyCodeLine{528     \}}
\DoxyCodeLine{529 }
\DoxyCodeLine{530 \}}
\DoxyCodeLine{531 }
\DoxyCodeLine{532 \textcolor{comment}{/*!***********************************************************************}}
\DoxyCodeLine{533 \textcolor{comment}{ @Function      GetModulationValue}}
\DoxyCodeLine{534 \textcolor{comment}{ @Input         x}}
\DoxyCodeLine{535 \textcolor{comment}{ @Input         y}}
\DoxyCodeLine{536 \textcolor{comment}{ @Input         Do2bitMode}}
\DoxyCodeLine{537 \textcolor{comment}{ @Input         ModulationVals}}
\DoxyCodeLine{538 \textcolor{comment}{ @Input         ModulationModes}}
\DoxyCodeLine{539 \textcolor{comment}{ @Input         Mod}}
\DoxyCodeLine{540 \textcolor{comment}{ @Input         DoPT}}
\DoxyCodeLine{541 \textcolor{comment}{ @Description   Get the modulation value as a numerator of a fraction of 8ths}}
\DoxyCodeLine{542 \textcolor{comment}{*************************************************************************/}}
\DoxyCodeLine{543 \textcolor{keyword}{static} \textcolor{keywordtype}{void} GetModulationValue(\textcolor{keywordtype}{int} x,}
\DoxyCodeLine{544                                \textcolor{keywordtype}{int} y,}
\DoxyCodeLine{545                                \textcolor{keyword}{const} \textcolor{keywordtype}{int} Do2bitMode,}
\DoxyCodeLine{546                                \textcolor{keyword}{const} \textcolor{keywordtype}{int} ModulationVals[8][16],}
\DoxyCodeLine{547                                \textcolor{keyword}{const} \textcolor{keywordtype}{int} ModulationModes[8][16],}
\DoxyCodeLine{548                                \textcolor{keywordtype}{int} *Mod,}
\DoxyCodeLine{549                                \textcolor{keywordtype}{int} *DoPT)}
\DoxyCodeLine{550 \{}
\DoxyCodeLine{551     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} RepVals0[4] = \{0, 3, 5, 8\};}
\DoxyCodeLine{552     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} RepVals1[4] = \{0, 4, 4, 8\};}
\DoxyCodeLine{553 }
\DoxyCodeLine{554     \textcolor{keywordtype}{int} ModVal;}
\DoxyCodeLine{555 }
\DoxyCodeLine{556     \textcolor{comment}{// Map X and Y into the local 2x2 block}}
\DoxyCodeLine{557     y = (y \& 0x3) | ((\string~y \& 0x2) << 1);}
\DoxyCodeLine{558 }
\DoxyCodeLine{559     \textcolor{keywordflow}{if}(Do2bitMode)}
\DoxyCodeLine{560         x = (x \& 0x7) | ((\string~x \& 0x4) << 1);}
\DoxyCodeLine{561     \textcolor{keywordflow}{else}}
\DoxyCodeLine{562         x = (x \& 0x3) | ((\string~x \& 0x2) << 1);}
\DoxyCodeLine{563 }
\DoxyCodeLine{564     \textcolor{comment}{// assume no PT for now}}
\DoxyCodeLine{565     *DoPT = 0;}
\DoxyCodeLine{566 }
\DoxyCodeLine{567     \textcolor{comment}{// extract the modulation value. If a simple encoding}}
\DoxyCodeLine{568     \textcolor{keywordflow}{if}(ModulationModes[y][x]==0)}
\DoxyCodeLine{569     \{}
\DoxyCodeLine{570         ModVal = RepVals0[ModulationVals[y][x]];}
\DoxyCodeLine{571     \}}
\DoxyCodeLine{572     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(Do2bitMode)}
\DoxyCodeLine{573     \{}
\DoxyCodeLine{574         \textcolor{comment}{// if this is a stored value}}
\DoxyCodeLine{575         \textcolor{keywordflow}{if}(((x\string^y)\&1)==0)}
\DoxyCodeLine{576             ModVal = RepVals0[ModulationVals[y][x]];}
\DoxyCodeLine{577         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(ModulationModes[y][x] == 1) \textcolor{comment}{// else average from the neighbours if H\&V interpolation..}}
\DoxyCodeLine{578         \{}
\DoxyCodeLine{579             ModVal = (RepVals0[ModulationVals[y-\/1][x]] +}
\DoxyCodeLine{580                       RepVals0[ModulationVals[y+1][x]] +}
\DoxyCodeLine{581                       RepVals0[ModulationVals[y][x-\/1]] +}
\DoxyCodeLine{582                       RepVals0[ModulationVals[y][x+1]] + 2) / 4;}
\DoxyCodeLine{583         \}}
\DoxyCodeLine{584         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(ModulationModes[y][x] == 2) \textcolor{comment}{// else if H-\/Only}}
\DoxyCodeLine{585         \{}
\DoxyCodeLine{586             ModVal = (RepVals0[ModulationVals[y][x-\/1]] +}
\DoxyCodeLine{587                       RepVals0[ModulationVals[y][x+1]] + 1) / 2;}
\DoxyCodeLine{588         \}}
\DoxyCodeLine{589         \textcolor{keywordflow}{else} \textcolor{comment}{// else it's V-\/Only}}
\DoxyCodeLine{590         \{}
\DoxyCodeLine{591             ModVal = (RepVals0[ModulationVals[y-\/1][x]] +}
\DoxyCodeLine{592                       RepVals0[ModulationVals[y+1][x]] + 1) / 2;}
\DoxyCodeLine{593         \}}
\DoxyCodeLine{594     \}}
\DoxyCodeLine{595     \textcolor{keywordflow}{else} \textcolor{comment}{// else it's 4BPP and PT encoding}}
\DoxyCodeLine{596     \{}
\DoxyCodeLine{597         ModVal = RepVals1[ModulationVals[y][x]];}
\DoxyCodeLine{598 }
\DoxyCodeLine{599         *DoPT = ModulationVals[y][x] == \mbox{\hyperlink{stbi__pvr__c_8h_ac01400b62d176e8f75fae8c905d23cbc}{PT\_INDEX}};}
\DoxyCodeLine{600     \}}
\DoxyCodeLine{601 }
\DoxyCodeLine{602     *Mod =ModVal;}
\DoxyCodeLine{603 \}}
\DoxyCodeLine{604 }
\DoxyCodeLine{605 \textcolor{comment}{/*!***********************************************************************}}
\DoxyCodeLine{606 \textcolor{comment}{ @Function      TwiddleUV}}
\DoxyCodeLine{607 \textcolor{comment}{ @Input         YSize   Y dimension of the texture in pixels}}
\DoxyCodeLine{608 \textcolor{comment}{ @Input         XSize   X dimension of the texture in pixels}}
\DoxyCodeLine{609 \textcolor{comment}{ @Input         YPos    Pixel Y position}}
\DoxyCodeLine{610 \textcolor{comment}{ @Input         XPos    Pixel X position}}
\DoxyCodeLine{611 \textcolor{comment}{ @Returns       The twiddled offset of the pixel}}
\DoxyCodeLine{612 \textcolor{comment}{ @Description   Given the Block (or pixel) coordinates and the dimension of}}
\DoxyCodeLine{613 \textcolor{comment}{                the texture in blocks (or pixels) this returns the twiddled}}
\DoxyCodeLine{614 \textcolor{comment}{                offset of the block (or pixel) from the start of the map.}}
\DoxyCodeLine{615 \textcolor{comment}{}}
\DoxyCodeLine{616 \textcolor{comment}{                NOTE the dimensions of the texture must be a power of 2}}
\DoxyCodeLine{617 \textcolor{comment}{*************************************************************************/}}
\DoxyCodeLine{618 \textcolor{keyword}{static} \textcolor{keywordtype}{int} DisableTwiddlingRoutine = 0;}
\DoxyCodeLine{619 }
\DoxyCodeLine{620 \textcolor{keyword}{static} \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} TwiddleUV(\mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} YSize, \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} XSize, \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} YPos, \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} XPos)}
\DoxyCodeLine{621 \{}
\DoxyCodeLine{622     \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} Twiddled;}
\DoxyCodeLine{623 }
\DoxyCodeLine{624     \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} MinDimension;}
\DoxyCodeLine{625     \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} MaxValue;}
\DoxyCodeLine{626 }
\DoxyCodeLine{627     \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} SrcBitPos;}
\DoxyCodeLine{628     \mbox{\hyperlink{stbi__pvr__c_8h_a1c37d65a438ff19a5493a561ee0ec4b6}{U32}} DstBitPos;}
\DoxyCodeLine{629 }
\DoxyCodeLine{630     \textcolor{keywordtype}{int} ShiftCount;}
\DoxyCodeLine{631 }
\DoxyCodeLine{632     assert(YPos < YSize);}
\DoxyCodeLine{633     assert(XPos < XSize);}
\DoxyCodeLine{634 }
\DoxyCodeLine{635     assert(\mbox{\hyperlink{stbi__pvr__c_8h_ab705c91ea5c52b11d32cd53d0477b3a5}{POWER\_OF\_2}}(YSize));}
\DoxyCodeLine{636     assert(\mbox{\hyperlink{stbi__pvr__c_8h_ab705c91ea5c52b11d32cd53d0477b3a5}{POWER\_OF\_2}}(XSize));}
\DoxyCodeLine{637 }
\DoxyCodeLine{638     \textcolor{keywordflow}{if}(YSize < XSize)}
\DoxyCodeLine{639     \{}
\DoxyCodeLine{640         MinDimension = YSize;}
\DoxyCodeLine{641         MaxValue     = XPos;}
\DoxyCodeLine{642     \}}
\DoxyCodeLine{643     \textcolor{keywordflow}{else}}
\DoxyCodeLine{644     \{}
\DoxyCodeLine{645         MinDimension = XSize;}
\DoxyCodeLine{646         MaxValue     = YPos;}
\DoxyCodeLine{647     \}}
\DoxyCodeLine{648 }
\DoxyCodeLine{649     \textcolor{comment}{// Nasty hack to disable twiddling}}
\DoxyCodeLine{650     \textcolor{keywordflow}{if}(DisableTwiddlingRoutine)}
\DoxyCodeLine{651         \textcolor{keywordflow}{return} (YPos* XSize + XPos);}
\DoxyCodeLine{652 }
\DoxyCodeLine{653     \textcolor{comment}{// Step through all the bits in the "{}minimum"{} dimension}}
\DoxyCodeLine{654     SrcBitPos = 1;}
\DoxyCodeLine{655     DstBitPos = 1;}
\DoxyCodeLine{656     Twiddled  = 0;}
\DoxyCodeLine{657     ShiftCount = 0;}
\DoxyCodeLine{658 }
\DoxyCodeLine{659     \textcolor{keywordflow}{while}(SrcBitPos < MinDimension)}
\DoxyCodeLine{660     \{}
\DoxyCodeLine{661         \textcolor{keywordflow}{if}(YPos \& SrcBitPos)}
\DoxyCodeLine{662         \{}
\DoxyCodeLine{663             Twiddled |= DstBitPos;}
\DoxyCodeLine{664         \}}
\DoxyCodeLine{665 }
\DoxyCodeLine{666         \textcolor{keywordflow}{if}(XPos \& SrcBitPos)}
\DoxyCodeLine{667         \{}
\DoxyCodeLine{668             Twiddled |= (DstBitPos << 1);}
\DoxyCodeLine{669         \}}
\DoxyCodeLine{670 }
\DoxyCodeLine{671 }
\DoxyCodeLine{672         SrcBitPos <<= 1;}
\DoxyCodeLine{673         DstBitPos <<= 2;}
\DoxyCodeLine{674         ShiftCount += 1;}
\DoxyCodeLine{675 }
\DoxyCodeLine{676     \}}
\DoxyCodeLine{677 }
\DoxyCodeLine{678     \textcolor{comment}{// prepend any unused bits}}
\DoxyCodeLine{679     MaxValue >>= ShiftCount;}
\DoxyCodeLine{680 }
\DoxyCodeLine{681     Twiddled |=  (MaxValue << (2*ShiftCount));}
\DoxyCodeLine{682 }
\DoxyCodeLine{683     \textcolor{keywordflow}{return} Twiddled;}
\DoxyCodeLine{684 \}}
\DoxyCodeLine{685 }
\DoxyCodeLine{686 \textcolor{comment}{/***********************************************************/}}
\DoxyCodeLine{687 \textcolor{comment}{/*}}
\DoxyCodeLine{688 \textcolor{comment}{// Decompress}}
\DoxyCodeLine{689 \textcolor{comment}{//}}
\DoxyCodeLine{690 \textcolor{comment}{// Takes the compressed input data and outputs the equivalent decompressed}}
\DoxyCodeLine{691 \textcolor{comment}{// image.}}
\DoxyCodeLine{692 \textcolor{comment}{*/}}
\DoxyCodeLine{693 \textcolor{comment}{/***********************************************************/}}
\DoxyCodeLine{694 }
\DoxyCodeLine{695 \textcolor{keyword}{static} \textcolor{keywordtype}{void} Decompress(\mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t}{AMTC\_BLOCK\_STRUCT}} *pCompressedData,}
\DoxyCodeLine{696                        \textcolor{keyword}{const} \textcolor{keywordtype}{int} Do2bitMode,}
\DoxyCodeLine{697                        \textcolor{keyword}{const} \textcolor{keywordtype}{int} XDim,}
\DoxyCodeLine{698                        \textcolor{keyword}{const} \textcolor{keywordtype}{int} YDim,}
\DoxyCodeLine{699                        \textcolor{keyword}{const} \textcolor{keywordtype}{int} AssumeImageTiles,}
\DoxyCodeLine{700                        \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* pResultImage)}
\DoxyCodeLine{701 \{}
\DoxyCodeLine{702     \textcolor{keywordtype}{int} x, y;}
\DoxyCodeLine{703     \textcolor{keywordtype}{int} i, j;}
\DoxyCodeLine{704 }
\DoxyCodeLine{705     \textcolor{keywordtype}{int} BlkX, BlkY;}
\DoxyCodeLine{706     \textcolor{keywordtype}{int} BlkXp1, BlkYp1;}
\DoxyCodeLine{707     \textcolor{keywordtype}{int} XBlockSize;}
\DoxyCodeLine{708     \textcolor{keywordtype}{int} BlkXDim, BlkYDim;}
\DoxyCodeLine{709 }
\DoxyCodeLine{710     \textcolor{keywordtype}{int} StartX, StartY;}
\DoxyCodeLine{711 }
\DoxyCodeLine{712     \textcolor{keywordtype}{int} ModulationVals[8][16];}
\DoxyCodeLine{713     \textcolor{keywordtype}{int} ModulationModes[8][16];}
\DoxyCodeLine{714 }
\DoxyCodeLine{715     \textcolor{keywordtype}{int} Mod, DoPT;}
\DoxyCodeLine{716 }
\DoxyCodeLine{717     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} uPosition;}
\DoxyCodeLine{718 }
\DoxyCodeLine{719     \textcolor{comment}{/*}}
\DoxyCodeLine{720 \textcolor{comment}{    // local neighbourhood of blocks}}
\DoxyCodeLine{721 \textcolor{comment}{    */}}
\DoxyCodeLine{722     \mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t}{AMTC\_BLOCK\_STRUCT}} *pBlocks[2][2];}
\DoxyCodeLine{723 }
\DoxyCodeLine{724     \mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t}{AMTC\_BLOCK\_STRUCT}} *pPrevious[2][2] = \{\{NULL, NULL\}, \{NULL, NULL\}\};}
\DoxyCodeLine{725 }
\DoxyCodeLine{726     \textcolor{comment}{/*}}
\DoxyCodeLine{727 \textcolor{comment}{    // Low precision colours extracted from the blocks}}
\DoxyCodeLine{728 \textcolor{comment}{    */}}
\DoxyCodeLine{729     \textcolor{keyword}{struct}}
\DoxyCodeLine{730     \{}
\DoxyCodeLine{731         \textcolor{keywordtype}{int} Reps[2][4];}
\DoxyCodeLine{732     \}Colours5554[2][2];}
\DoxyCodeLine{733 }
\DoxyCodeLine{734     \textcolor{comment}{/*}}
\DoxyCodeLine{735 \textcolor{comment}{    // Interpolated A and B colours for the pixel}}
\DoxyCodeLine{736 \textcolor{comment}{    */}}
\DoxyCodeLine{737     \textcolor{keywordtype}{int} ASig[4], BSig[4];}
\DoxyCodeLine{738 }
\DoxyCodeLine{739     \textcolor{keywordtype}{int} Result[4];}
\DoxyCodeLine{740 }
\DoxyCodeLine{741     \textcolor{keywordflow}{if}(Do2bitMode)}
\DoxyCodeLine{742     \{}
\DoxyCodeLine{743         XBlockSize = \mbox{\hyperlink{stbi__pvr__c_8h_a70b6ed94c74b741311fe614a35fa7747}{BLK\_X\_2BPP}};}
\DoxyCodeLine{744     \}}
\DoxyCodeLine{745     \textcolor{keywordflow}{else}}
\DoxyCodeLine{746     \{}
\DoxyCodeLine{747         XBlockSize = \mbox{\hyperlink{stbi__pvr__c_8h_ac1db0a9ee13763c6340b18ae5c50e728}{BLK\_X\_4BPP}};}
\DoxyCodeLine{748     \}}
\DoxyCodeLine{749 }
\DoxyCodeLine{750 }
\DoxyCodeLine{751     \textcolor{comment}{/*}}
\DoxyCodeLine{752 \textcolor{comment}{    // For MBX don't allow the sizes to get too small}}
\DoxyCodeLine{753 \textcolor{comment}{    */}}
\DoxyCodeLine{754     BlkXDim = \mbox{\hyperlink{stbi__pvr__c_8h_ad2469b54167e39e7cd51c6ffa37725a0}{PVRT\_MAX}}(2, XDim / XBlockSize);}
\DoxyCodeLine{755     BlkYDim = \mbox{\hyperlink{stbi__pvr__c_8h_ad2469b54167e39e7cd51c6ffa37725a0}{PVRT\_MAX}}(2, YDim / \mbox{\hyperlink{stbi__pvr__c_8h_ab04e838877fc1df19927d5753108c96e}{BLK\_Y\_SIZE}});}
\DoxyCodeLine{756 }
\DoxyCodeLine{757     \textcolor{comment}{/*}}
\DoxyCodeLine{758 \textcolor{comment}{    // Step through the pixels of the image decompressing each one in turn}}
\DoxyCodeLine{759 \textcolor{comment}{    //}}
\DoxyCodeLine{760 \textcolor{comment}{    // Note that this is a hideously inefficient way to do this!}}
\DoxyCodeLine{761 \textcolor{comment}{    */}}
\DoxyCodeLine{762     \textcolor{keywordflow}{for}(y = 0; y < YDim; y++)}
\DoxyCodeLine{763     \{}
\DoxyCodeLine{764         \textcolor{keywordflow}{for}(x = 0; x < XDim; x++)}
\DoxyCodeLine{765         \{}
\DoxyCodeLine{766             \textcolor{comment}{/*}}
\DoxyCodeLine{767 \textcolor{comment}{            // map this pixel to the top left neighbourhood of blocks}}
\DoxyCodeLine{768 \textcolor{comment}{            */}}
\DoxyCodeLine{769             BlkX = (x -\/ XBlockSize/2);}
\DoxyCodeLine{770             BlkY = (y -\/ \mbox{\hyperlink{stbi__pvr__c_8h_ab04e838877fc1df19927d5753108c96e}{BLK\_Y\_SIZE}}/2);}
\DoxyCodeLine{771 }
\DoxyCodeLine{772             BlkX = \mbox{\hyperlink{stbi__pvr__c_8h_a95d5396a84f049ef3c096174e5fefbb9}{LIMIT\_COORD}}(BlkX, XDim, AssumeImageTiles);}
\DoxyCodeLine{773             BlkY = \mbox{\hyperlink{stbi__pvr__c_8h_a95d5396a84f049ef3c096174e5fefbb9}{LIMIT\_COORD}}(BlkY, YDim, AssumeImageTiles);}
\DoxyCodeLine{774 }
\DoxyCodeLine{775 }
\DoxyCodeLine{776             BlkX /= XBlockSize;}
\DoxyCodeLine{777             BlkY /= \mbox{\hyperlink{stbi__pvr__c_8h_ab04e838877fc1df19927d5753108c96e}{BLK\_Y\_SIZE}};}
\DoxyCodeLine{778 }
\DoxyCodeLine{779             \textcolor{comment}{//BlkX = LIMIT\_COORD(BlkX, BlkXDim, AssumeImageTiles);}}
\DoxyCodeLine{780             \textcolor{comment}{//BlkY = LIMIT\_COORD(BlkY, BlkYDim, AssumeImageTiles);}}
\DoxyCodeLine{781 }
\DoxyCodeLine{782 }
\DoxyCodeLine{783             \textcolor{comment}{/*}}
\DoxyCodeLine{784 \textcolor{comment}{            // compute the positions of the other 3 blocks}}
\DoxyCodeLine{785 \textcolor{comment}{            */}}
\DoxyCodeLine{786             BlkXp1 = \mbox{\hyperlink{stbi__pvr__c_8h_a95d5396a84f049ef3c096174e5fefbb9}{LIMIT\_COORD}}(BlkX+1, BlkXDim, AssumeImageTiles);}
\DoxyCodeLine{787             BlkYp1 = \mbox{\hyperlink{stbi__pvr__c_8h_a95d5396a84f049ef3c096174e5fefbb9}{LIMIT\_COORD}}(BlkY+1, BlkYDim, AssumeImageTiles);}
\DoxyCodeLine{788 }
\DoxyCodeLine{789             \textcolor{comment}{/*}}
\DoxyCodeLine{790 \textcolor{comment}{            // Map to block memory locations}}
\DoxyCodeLine{791 \textcolor{comment}{            */}}
\DoxyCodeLine{792             pBlocks[0][0] = pCompressedData +TwiddleUV(BlkYDim, BlkXDim, BlkY, BlkX);}
\DoxyCodeLine{793             pBlocks[0][1] = pCompressedData +TwiddleUV(BlkYDim, BlkXDim, BlkY, BlkXp1);}
\DoxyCodeLine{794             pBlocks[1][0] = pCompressedData +TwiddleUV(BlkYDim, BlkXDim, BlkYp1, BlkX);}
\DoxyCodeLine{795             pBlocks[1][1] = pCompressedData +TwiddleUV(BlkYDim, BlkXDim, BlkYp1, BlkXp1);}
\DoxyCodeLine{796 }
\DoxyCodeLine{797 }
\DoxyCodeLine{798             \textcolor{comment}{/*}}
\DoxyCodeLine{799 \textcolor{comment}{            // extract the colours and the modulation information IF the previous values}}
\DoxyCodeLine{800 \textcolor{comment}{            // have changed.}}
\DoxyCodeLine{801 \textcolor{comment}{            */}}
\DoxyCodeLine{802             \textcolor{keywordflow}{if}(memcmp(pPrevious, pBlocks, 4*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}*)) != 0)}
\DoxyCodeLine{803             \{}
\DoxyCodeLine{804                 StartY = 0;}
\DoxyCodeLine{805                 \textcolor{keywordflow}{for}(i = 0; i < 2; i++)}
\DoxyCodeLine{806                 \{}
\DoxyCodeLine{807                     StartX = 0;}
\DoxyCodeLine{808                     \textcolor{keywordflow}{for}(j = 0; j < 2; j++)}
\DoxyCodeLine{809                     \{}
\DoxyCodeLine{810                         Unpack5554Colour(pBlocks[i][j], Colours5554[i][j].Reps);}
\DoxyCodeLine{811 }
\DoxyCodeLine{812                         UnpackModulations(pBlocks[i][j],}
\DoxyCodeLine{813                             Do2bitMode,}
\DoxyCodeLine{814                             ModulationVals,}
\DoxyCodeLine{815                             ModulationModes,}
\DoxyCodeLine{816                             StartX, StartY);}
\DoxyCodeLine{817 }
\DoxyCodeLine{818                         StartX += XBlockSize;}
\DoxyCodeLine{819                     \}\textcolor{comment}{/*end for j*/}}
\DoxyCodeLine{820 }
\DoxyCodeLine{821                     StartY += \mbox{\hyperlink{stbi__pvr__c_8h_ab04e838877fc1df19927d5753108c96e}{BLK\_Y\_SIZE}};}
\DoxyCodeLine{822                 \}\textcolor{comment}{/*end for i*/}}
\DoxyCodeLine{823 }
\DoxyCodeLine{824                 \textcolor{comment}{/*}}
\DoxyCodeLine{825 \textcolor{comment}{                // make a copy of the new pointers}}
\DoxyCodeLine{826 \textcolor{comment}{                */}}
\DoxyCodeLine{827                 memcpy(pPrevious, pBlocks, 4*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void}*));}
\DoxyCodeLine{828             \}\textcolor{comment}{/*end if the blocks have changed*/}}
\DoxyCodeLine{829 }
\DoxyCodeLine{830 }
\DoxyCodeLine{831             \textcolor{comment}{/*}}
\DoxyCodeLine{832 \textcolor{comment}{            // decompress the pixel.  First compute the interpolated A and B signals}}
\DoxyCodeLine{833 \textcolor{comment}{            */}}
\DoxyCodeLine{834             InterpolateColours(Colours5554[0][0].Reps[0],}
\DoxyCodeLine{835                 Colours5554[0][1].Reps[0],}
\DoxyCodeLine{836                 Colours5554[1][0].Reps[0],}
\DoxyCodeLine{837                 Colours5554[1][1].Reps[0],}
\DoxyCodeLine{838                 Do2bitMode, x, y,}
\DoxyCodeLine{839                 ASig);}
\DoxyCodeLine{840 }
\DoxyCodeLine{841             InterpolateColours(Colours5554[0][0].Reps[1],}
\DoxyCodeLine{842                 Colours5554[0][1].Reps[1],}
\DoxyCodeLine{843                 Colours5554[1][0].Reps[1],}
\DoxyCodeLine{844                 Colours5554[1][1].Reps[1],}
\DoxyCodeLine{845                 Do2bitMode, x, y,}
\DoxyCodeLine{846                 BSig);}
\DoxyCodeLine{847 }
\DoxyCodeLine{848             GetModulationValue(x,y, Do2bitMode, (\textcolor{keyword}{const} \textcolor{keywordtype}{int} (*)[16])ModulationVals, (\textcolor{keyword}{const} \textcolor{keywordtype}{int} (*)[16])ModulationModes,}
\DoxyCodeLine{849                 \&Mod, \&DoPT);}
\DoxyCodeLine{850 }
\DoxyCodeLine{851             \textcolor{comment}{/*}}
\DoxyCodeLine{852 \textcolor{comment}{            // compute the modulated colour}}
\DoxyCodeLine{853 \textcolor{comment}{            */}}
\DoxyCodeLine{854             \textcolor{keywordflow}{for}(i = 0; i < 4; i++)}
\DoxyCodeLine{855             \{}
\DoxyCodeLine{856                 Result[i] = ASig[i] * 8 + Mod * (BSig[i] -\/ ASig[i]);}
\DoxyCodeLine{857                 Result[i] >>= 3;}
\DoxyCodeLine{858             \}}
\DoxyCodeLine{859             \textcolor{keywordflow}{if}(DoPT)}
\DoxyCodeLine{860             \{}
\DoxyCodeLine{861                 Result[3] = 0;}
\DoxyCodeLine{862             \}}
\DoxyCodeLine{863 }
\DoxyCodeLine{864             \textcolor{comment}{/*}}
\DoxyCodeLine{865 \textcolor{comment}{            // Store the result in the output image}}
\DoxyCodeLine{866 \textcolor{comment}{            */}}
\DoxyCodeLine{867             uPosition = (x+y*XDim)<<2;}
\DoxyCodeLine{868             pResultImage[uPosition+0] = (\textcolor{keywordtype}{unsigned} char)Result[0];}
\DoxyCodeLine{869             pResultImage[uPosition+1] = (\textcolor{keywordtype}{unsigned} char)Result[1];}
\DoxyCodeLine{870             pResultImage[uPosition+2] = (\textcolor{keywordtype}{unsigned} char)Result[2];}
\DoxyCodeLine{871             pResultImage[uPosition+3] = (\textcolor{keywordtype}{unsigned} char)Result[3];}
\DoxyCodeLine{872 }
\DoxyCodeLine{873         \}\textcolor{comment}{/*end for x*/}}
\DoxyCodeLine{874     \}\textcolor{comment}{/*end for y*/}}
\DoxyCodeLine{875 }
\DoxyCodeLine{876 \}}
\DoxyCodeLine{877 }
\DoxyCodeLine{878 \textcolor{keyword}{static} \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} * stbi\_\_pvr\_load(\mbox{\hyperlink{structstbi____context}{stbi\_\_context}} *s, \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{879 \{}
\DoxyCodeLine{880     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} *pvr\_data = NULL;}
\DoxyCodeLine{881     \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} *pvr\_res\_data = NULL;}
\DoxyCodeLine{882     \mbox{\hyperlink{struct_p_v_r___texture___header}{PVR\_Texture\_Header}} header=\{0\};}
\DoxyCodeLine{883     \textcolor{keywordtype}{int} iscompressed = 0;}
\DoxyCodeLine{884     \textcolor{keywordtype}{int} bitmode = 0;}
\DoxyCodeLine{885     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} levelSize = 0;}
\DoxyCodeLine{886 }
\DoxyCodeLine{887     stbi\_\_getn( s, (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}}*)(\&header), \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_p_v_r___texture___header}{PVR\_Texture\_Header}}) );}
\DoxyCodeLine{888 }
\DoxyCodeLine{889     \textcolor{comment}{// Check the header size}}
\DoxyCodeLine{890     \textcolor{keywordflow}{if} ( header.\mbox{\hyperlink{struct_p_v_r___texture___header_a1b70d66c96e4291a170028d0ba6bac0e}{dwHeaderSize}} != \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_p_v_r___texture___header}{PVR\_Texture\_Header}}) ) \{}
\DoxyCodeLine{891         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{892     \}}
\DoxyCodeLine{893 }
\DoxyCodeLine{894     \textcolor{comment}{// Check the magic identifier}}
\DoxyCodeLine{895     \textcolor{keywordflow}{if} ( header.\mbox{\hyperlink{struct_p_v_r___texture___header_a1aa3e8921cb7576374622129a952dd72}{dwPVR}} != \mbox{\hyperlink{pvr__helper_8h_a104653e6ff73a0cc635baac386e1472c}{PVRTEX\_IDENTIFIER}} ) \{}
\DoxyCodeLine{896         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{897     \}}
\DoxyCodeLine{898 }
\DoxyCodeLine{899     *x = s-\/>\mbox{\hyperlink{structstbi____context_a1ef0d00dcf3fbc9ea468995b1b53fbeb}{img\_x}} = header.\mbox{\hyperlink{struct_p_v_r___texture___header_a35506d49c7fb8fe89cf2d35ec1727bdd}{dwWidth}};}
\DoxyCodeLine{900     *y = s-\/>\mbox{\hyperlink{structstbi____context_a5392767d41a587c3773d70ad2f8f33be}{img\_y}} = header.\mbox{\hyperlink{struct_p_v_r___texture___header_a5c9d7a15be622005fae8247ea1d593df}{dwHeight}};}
\DoxyCodeLine{901 }
\DoxyCodeLine{902     \textcolor{comment}{/* Get if the texture is compressed and the texture mode ( 2bpp or 4bpp ) */}}
\DoxyCodeLine{903     \textcolor{keywordflow}{switch} ( header.\mbox{\hyperlink{struct_p_v_r___texture___header_ab89dc74cf18383d2d41397e2e839faeb}{dwpfFlags}} \& \mbox{\hyperlink{pvr__helper_8h_aa112a7c808c701182cd162010bac3fe8}{PVRTEX\_PIXELTYPE}} )}
\DoxyCodeLine{904     \{}
\DoxyCodeLine{905         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da4a7dd3e4d68a93bb9f3eebbfb71f6bdf}{OGL\_RGBA\_4444}}:}
\DoxyCodeLine{906             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 2;}
\DoxyCodeLine{907             \textcolor{keywordflow}{break};}
\DoxyCodeLine{908         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da9632cdc28718895d0470ba7306b19546}{OGL\_RGBA\_5551}}:}
\DoxyCodeLine{909             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 2;}
\DoxyCodeLine{910             \textcolor{keywordflow}{break};}
\DoxyCodeLine{911         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da1f7fd9d8c860667adb5a60ea4fb2aa43}{OGL\_RGBA\_8888}}:}
\DoxyCodeLine{912             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 4;}
\DoxyCodeLine{913             \textcolor{keywordflow}{break};}
\DoxyCodeLine{914         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da4409cb1d0e3ddfa4bf4bfb8308f27632}{OGL\_RGB\_565}}:}
\DoxyCodeLine{915             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 2;}
\DoxyCodeLine{916             \textcolor{keywordflow}{break};}
\DoxyCodeLine{917         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3dae8a8e5d8c477b94fccb55da1f44ebfa5}{OGL\_RGB\_888}}:}
\DoxyCodeLine{918             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 3;}
\DoxyCodeLine{919             \textcolor{keywordflow}{break};}
\DoxyCodeLine{920         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da1bcb380c3b68d541e46ceb0cef4e3b65}{OGL\_I\_8}}:}
\DoxyCodeLine{921             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 1;}
\DoxyCodeLine{922             \textcolor{keywordflow}{break};}
\DoxyCodeLine{923         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da349513ba96fc8b71a2c116d3ebe8623e}{OGL\_AI\_88}}:}
\DoxyCodeLine{924             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 2;}
\DoxyCodeLine{925             \textcolor{keywordflow}{break};}
\DoxyCodeLine{926         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3da38367577de4271e8bd818ca4e03f5722}{OGL\_PVRTC2}}:}
\DoxyCodeLine{927             bitmode = 1;}
\DoxyCodeLine{928             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 4;}
\DoxyCodeLine{929             iscompressed = 1;}
\DoxyCodeLine{930             \textcolor{keywordflow}{break};}
\DoxyCodeLine{931         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3dad833a496a6fd87dcb555687f22c7e954}{OGL\_PVRTC4}}:}
\DoxyCodeLine{932             s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} = 4;}
\DoxyCodeLine{933             iscompressed = 1;}
\DoxyCodeLine{934             \textcolor{keywordflow}{break};}
\DoxyCodeLine{935         \textcolor{keywordflow}{case} \mbox{\hyperlink{pvr__helper_8h_a37140413518dff2aa63096a2e31b9b3daa01f1871147a252d5d979f98d2d37e1f}{OGL\_RGB\_555}}:}
\DoxyCodeLine{936         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{937             \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{938     \}}
\DoxyCodeLine{939 }
\DoxyCodeLine{940     *comp = s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}};}
\DoxyCodeLine{941 }
\DoxyCodeLine{942     \textcolor{comment}{// Load only the first mip map level}}
\DoxyCodeLine{943     levelSize = (s-\/>\mbox{\hyperlink{structstbi____context_a1ef0d00dcf3fbc9ea468995b1b53fbeb}{img\_x}} * s-\/>\mbox{\hyperlink{structstbi____context_a5392767d41a587c3773d70ad2f8f33be}{img\_y}} * header.\mbox{\hyperlink{struct_p_v_r___texture___header_adc064257d63a00e00e131c7d93728067}{dwBitCount}} + 7) / 8;}
\DoxyCodeLine{944 }
\DoxyCodeLine{945     \textcolor{comment}{// get the raw data}}
\DoxyCodeLine{946     pvr\_data = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} *)malloc( levelSize );}
\DoxyCodeLine{947     stbi\_\_getn( s, pvr\_data, levelSize );}
\DoxyCodeLine{948 }
\DoxyCodeLine{949     \textcolor{comment}{// if compressed decompress as RGBA}}
\DoxyCodeLine{950     \textcolor{keywordflow}{if} ( iscompressed ) \{}
\DoxyCodeLine{951         pvr\_res\_data = (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} *)malloc( s-\/>\mbox{\hyperlink{structstbi____context_a1ef0d00dcf3fbc9ea468995b1b53fbeb}{img\_x}} * s-\/>\mbox{\hyperlink{structstbi____context_a5392767d41a587c3773d70ad2f8f33be}{img\_y}} * 4 );}
\DoxyCodeLine{952         Decompress( (\mbox{\hyperlink{struct_a_m_t_c___b_l_o_c_k___s_t_r_u_c_t}{AMTC\_BLOCK\_STRUCT}}*)pvr\_data, bitmode, s-\/>\mbox{\hyperlink{structstbi____context_a1ef0d00dcf3fbc9ea468995b1b53fbeb}{img\_x}}, s-\/>\mbox{\hyperlink{structstbi____context_a5392767d41a587c3773d70ad2f8f33be}{img\_y}}, 1, (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)pvr\_res\_data );}
\DoxyCodeLine{953         free( pvr\_data );}
\DoxyCodeLine{954     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{955         \textcolor{comment}{// otherwise use the raw data}}
\DoxyCodeLine{956         pvr\_res\_data = pvr\_data;}
\DoxyCodeLine{957     \}}
\DoxyCodeLine{958 }
\DoxyCodeLine{959     \textcolor{keywordflow}{if}( (req\_comp <= 4) \&\& (req\_comp >= 1) ) \{}
\DoxyCodeLine{960         \textcolor{comment}{//  user has some requirements, meet them}}
\DoxyCodeLine{961         \textcolor{keywordflow}{if}( req\_comp != s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}} ) \{}
\DoxyCodeLine{962             pvr\_res\_data = stbi\_\_convert\_format( pvr\_res\_data, s-\/>\mbox{\hyperlink{structstbi____context_afc068268e1f91a33627f2e7ce3b84e26}{img\_n}}, req\_comp, s-\/>\mbox{\hyperlink{structstbi____context_a1ef0d00dcf3fbc9ea468995b1b53fbeb}{img\_x}}, s-\/>\mbox{\hyperlink{structstbi____context_a5392767d41a587c3773d70ad2f8f33be}{img\_y}} );}
\DoxyCodeLine{963             *comp = req\_comp;}
\DoxyCodeLine{964         \}}
\DoxyCodeLine{965     \}}
\DoxyCodeLine{966 }
\DoxyCodeLine{967     \textcolor{keywordflow}{return} pvr\_res\_data;}
\DoxyCodeLine{968 \}}
\DoxyCodeLine{969 }
\DoxyCodeLine{970 \textcolor{preprocessor}{\#ifndef STBI\_NO\_STDIO}}
\DoxyCodeLine{971 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} *\mbox{\hyperlink{stbi__pvr__c_8h_a34c295303f550807d31b9e745dfbd373}{stbi\_\_pvr\_load\_from\_file}}   (FILE *f,                  \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{972 \{}
\DoxyCodeLine{973     \mbox{\hyperlink{structstbi____context}{stbi\_\_context}} s;}
\DoxyCodeLine{974     stbi\_\_start\_file(\&s,f);}
\DoxyCodeLine{975     \textcolor{keywordflow}{return} stbi\_\_pvr\_load(\&s,x,y,comp,req\_comp);}
\DoxyCodeLine{976 \}}
\DoxyCodeLine{977 }
\DoxyCodeLine{978 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} *\mbox{\hyperlink{stbi__pvr__c_8h_a2e3ecf7085bead22974fe86053b36a25}{stbi\_\_pvr\_load\_from\_path}}             (\textcolor{keywordtype}{char} \textcolor{keyword}{const}*filename,           \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{979 \{}
\DoxyCodeLine{980    \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} *data;}
\DoxyCodeLine{981    FILE *f = fopen(filename, \textcolor{stringliteral}{"{}rb"{}});}
\DoxyCodeLine{982    \textcolor{keywordflow}{if} (!f) \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{983    data = \mbox{\hyperlink{stbi__pvr__c_8h_a34c295303f550807d31b9e745dfbd373}{stbi\_\_pvr\_load\_from\_file}}(f,x,y,comp,req\_comp);}
\DoxyCodeLine{984    fclose(f);}
\DoxyCodeLine{985    \textcolor{keywordflow}{return} data;}
\DoxyCodeLine{986 \}}
\DoxyCodeLine{987 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{988 }
\DoxyCodeLine{989 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} *\mbox{\hyperlink{stbi__pvr__c_8h_afd4771a36878690cfa0ae1a514b13899}{stbi\_\_pvr\_load\_from\_memory}} (\mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} \textcolor{keyword}{const} *buffer, \textcolor{keywordtype}{int} len, \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{990 \{}
\DoxyCodeLine{991    \mbox{\hyperlink{structstbi____context}{stbi\_\_context}} s;}
\DoxyCodeLine{992    stbi\_\_start\_mem(\&s,buffer, len);}
\DoxyCodeLine{993    \textcolor{keywordflow}{return} stbi\_\_pvr\_load(\&s,x,y,comp,req\_comp);}
\DoxyCodeLine{994 \}}
\DoxyCodeLine{995 }
\DoxyCodeLine{996 \mbox{\hyperlink{stb__image_8h_a28eb51a1512ce382ee50f20e1d04d50d}{stbi\_uc}} *\mbox{\hyperlink{stbi__pvr__c_8h_a958724f257fcb40389dd88fa9f7e0275}{stbi\_\_pvr\_load\_from\_callbacks}} (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} \textcolor{keyword}{const} *clbk, \textcolor{keywordtype}{void} *user, \textcolor{keywordtype}{int} *x, \textcolor{keywordtype}{int} *y, \textcolor{keywordtype}{int} *comp, \textcolor{keywordtype}{int} req\_comp)}
\DoxyCodeLine{997 \{}
\DoxyCodeLine{998     \mbox{\hyperlink{structstbi____context}{stbi\_\_context}} s;}
\DoxyCodeLine{999    stbi\_\_start\_callbacks(\&s, (\mbox{\hyperlink{structstbi__io__callbacks}{stbi\_io\_callbacks}} *) clbk, user);}
\DoxyCodeLine{1000    \textcolor{keywordflow}{return} stbi\_\_pvr\_load(\&s,x,y,comp,req\_comp);}
\DoxyCodeLine{1001 \}}

\end{DoxyCode}
