\hypertarget{_joystick_8hpp_source}{}\doxysection{Joystick.\+hpp}
\label{_joystick_8hpp_source}\index{source/Devices/Joystick.hpp@{source/Devices/Joystick.hpp}}
\mbox{\hyperlink{_joystick_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#include <iomanip>}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <sstream>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <bitset>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <ciso646>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <glad/glad.h>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <GLFW/glfw3.h>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{shape_8h}{grafica/shape.h}}>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{basic__shapes_8h}{grafica/basic\_shapes.h}}>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{load__shaders_8h}{grafica/load\_shaders.h}}>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{performance__monitor_8h}{grafica/performance\_monitor.h}}>}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{easy__shaders_8h}{grafica/easy\_shaders.h}}>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{gpu__shape_8h}{grafica/gpu\_shape.h}}>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{transformations_8h}{grafica/transformations.h}}>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_sincronia}{Sincronia}} \{}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 }
\DoxyCodeLine{29 }
\DoxyCodeLine{30     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespace_sincronia_ac335102050ee81f0d5348c03f924a5b6}{joystick\_callback}}(\textcolor{keywordtype}{int} jid, \textcolor{keywordtype}{int} event)}
\DoxyCodeLine{31     \{}
\DoxyCodeLine{32         \textcolor{keywordflow}{if} (event == GLFW\_CONNECTED)}
\DoxyCodeLine{33         \{}
\DoxyCodeLine{34             \textcolor{comment}{// The joystick was connected}}
\DoxyCodeLine{35             std::cout << \textcolor{stringliteral}{"{}The joystick "{}} << jid << \textcolor{stringliteral}{"{} was connected"{}} << std::endl;}
\DoxyCodeLine{36         \}}
\DoxyCodeLine{37         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (event == GLFW\_DISCONNECTED)}
\DoxyCodeLine{38         \{}
\DoxyCodeLine{39             \textcolor{comment}{// The joystick was disconnected}}
\DoxyCodeLine{40             std::cout << \textcolor{stringliteral}{"{}The joystick "{}} << jid << \textcolor{stringliteral}{"{} was disconnected"{}} << std::endl;}
\DoxyCodeLine{41         \}}
\DoxyCodeLine{42     \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{47     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_sincronia_1_1_joystick}{Joystick}}}
\DoxyCodeLine{48     \{}
\DoxyCodeLine{49         std::vector<bool> \mbox{\hyperlink{struct_sincronia_1_1_joystick_a61ce1d1cdce460f7c70d935a37bb3ea2}{buttons}};}
\DoxyCodeLine{50         std::vector<float> \mbox{\hyperlink{struct_sincronia_1_1_joystick_a409a1ea5ac18da903dfe8706e1a89ab6}{axes}};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         \mbox{\hyperlink{struct_sincronia_1_1_joystick_a6d02881a0af1a097b5ec0e0dc6c75d30}{Joystick}}(std::size\_t \textcolor{keyword}{const} numberOfButtons, std::size\_t \textcolor{keyword}{const} numberOfAxes) :}
\DoxyCodeLine{53             \mbox{\hyperlink{struct_sincronia_1_1_joystick_a61ce1d1cdce460f7c70d935a37bb3ea2}{buttons}}(numberOfButtons, false), \mbox{\hyperlink{struct_sincronia_1_1_joystick_a409a1ea5ac18da903dfe8706e1a89ab6}{axes}}(numberOfAxes, 0.0f)}
\DoxyCodeLine{54         \{}
\DoxyCodeLine{55         \}}
\DoxyCodeLine{56     \};}
\DoxyCodeLine{57 }
\DoxyCodeLine{58     std::ostream\& \mbox{\hyperlink{namespace_sincronia_a999f554032976a698d2935b430c551dc}{operator<<}}(std::ostream\& os, \textcolor{keyword}{const} \mbox{\hyperlink{struct_sincronia_1_1_joystick}{Joystick}}\& joystick)}
\DoxyCodeLine{59     \{}
\DoxyCodeLine{60         os << \textcolor{stringliteral}{"{}buttons: "{}};}
\DoxyCodeLine{61         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{bool} button : joystick.\mbox{\hyperlink{struct_sincronia_1_1_joystick_a61ce1d1cdce460f7c70d935a37bb3ea2}{buttons}})}
\DoxyCodeLine{62         \{}
\DoxyCodeLine{63             os << (button ? 1 : 0);}
\DoxyCodeLine{64         \}}
\DoxyCodeLine{65         os << \textcolor{stringliteral}{"{} axes: "{}};}
\DoxyCodeLine{66         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{float} ax : joystick.\mbox{\hyperlink{struct_sincronia_1_1_joystick_a409a1ea5ac18da903dfe8706e1a89ab6}{axes}})}
\DoxyCodeLine{67         \{}
\DoxyCodeLine{68             os << std::fixed << std::setprecision(2) << std::setfill(\textcolor{charliteral}{'0'}) << ax << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{69         \}}
\DoxyCodeLine{70         \textcolor{keywordflow}{return} os;}
\DoxyCodeLine{71     \}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73     \textcolor{comment}{/* A convenient type to identify specific joysticks. */}}
\DoxyCodeLine{74     \textcolor{keyword}{using} \mbox{\hyperlink{namespace_sincronia_a706b02c6136f78bf02db01272e121873}{JoystickId}} = std::size\_t;}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     \textcolor{comment}{/* Convenient storage for all joysticks. They can be accessed by their id.}}
\DoxyCodeLine{77 \textcolor{comment}{     * Do note that due to connections and disconnections, the joystick ids may not be succesive numbers.}}
\DoxyCodeLine{78 \textcolor{comment}{     * This way, to use an std::vector would require additional logic. */}}
\DoxyCodeLine{79     \textcolor{keyword}{using} \mbox{\hyperlink{namespace_sincronia_a897b50f5cad73b530b50e0bf748f16ed}{JoystickContainer}} = std::unordered\_map<JoystickId, Joystick>;}
\DoxyCodeLine{80 }
\DoxyCodeLine{85     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespace_sincronia_a3bb74ddcf98972267635b04b1713b587}{pollJoysticks}}(\mbox{\hyperlink{namespace_sincronia_a897b50f5cad73b530b50e0bf748f16ed}{JoystickContainer}}\& joysticks)}
\DoxyCodeLine{86     \{}
\DoxyCodeLine{87         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} joystickId = GLFW\_JOYSTICK\_1; joystickId < GLFW\_JOYSTICK\_LAST; ++joystickId)}
\DoxyCodeLine{88         \{}
\DoxyCodeLine{89             \textcolor{keywordtype}{int} \textcolor{keyword}{const} joystickConnected = glfwJoystickPresent(joystickId);}
\DoxyCodeLine{90             \textcolor{keywordflow}{if} (joystickConnected == GLFW\_FALSE)}
\DoxyCodeLine{91             \{}
\DoxyCodeLine{92                 \textcolor{keywordflow}{if} (joysticks.count(joystickId) != 0)}
\DoxyCodeLine{93                 \{}
\DoxyCodeLine{94                     \textcolor{comment}{/* joystickId has been disconnected.*/}}
\DoxyCodeLine{95                     joysticks.erase(joystickId);}
\DoxyCodeLine{96                 \}}
\DoxyCodeLine{97                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{98             \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100             \textcolor{comment}{// At this point we have a joystick with this id.}}
\DoxyCodeLine{101             \textcolor{keywordflow}{if} (joysticks.count(joystickId) == 0)}
\DoxyCodeLine{102             \{}
\DoxyCodeLine{103                 \textcolor{comment}{/* joystickId has been connected.*/}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105                 \textcolor{keywordtype}{int} buttonsCount;}
\DoxyCodeLine{106                 glfwGetJoystickButtons(joystickId, \&buttonsCount);}
\DoxyCodeLine{107 }
\DoxyCodeLine{108                 \textcolor{keywordtype}{int} axesCount;}
\DoxyCodeLine{109                 glfwGetJoystickAxes(joystickId, \&axesCount);}
\DoxyCodeLine{110 }
\DoxyCodeLine{111                 joysticks.emplace(joystickId, \mbox{\hyperlink{struct_sincronia_1_1_joystick}{Joystick}}(buttonsCount, axesCount));}
\DoxyCodeLine{112             \}}
\DoxyCodeLine{113 }
\DoxyCodeLine{114             \mbox{\hyperlink{struct_sincronia_1_1_joystick}{Joystick}}\& joystick = joysticks.at(joystickId);}
\DoxyCodeLine{115 }
\DoxyCodeLine{116             \textcolor{keywordtype}{int} buttonsCount;}
\DoxyCodeLine{117             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* buttons = glfwGetJoystickButtons(joystickId, \&buttonsCount);}
\DoxyCodeLine{118             assert(joystick.\mbox{\hyperlink{struct_sincronia_1_1_joystick_a61ce1d1cdce460f7c70d935a37bb3ea2}{buttons}}.size() == buttonsCount);}
\DoxyCodeLine{119 }
\DoxyCodeLine{120             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} buttonId = 0; buttonId < buttonsCount; ++buttonId)}
\DoxyCodeLine{121             \{}
\DoxyCodeLine{122                 joystick.\mbox{\hyperlink{struct_sincronia_1_1_joystick_a61ce1d1cdce460f7c70d935a37bb3ea2}{buttons}}[buttonId] = buttons[buttonId] == GLFW\_PRESS;}
\DoxyCodeLine{123             \}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125             \textcolor{keywordtype}{int} axesCount;}
\DoxyCodeLine{126             \textcolor{keyword}{const} \textcolor{keywordtype}{float}* axes = glfwGetJoystickAxes(joystickId, \&axesCount);}
\DoxyCodeLine{127             assert(joystick.\mbox{\hyperlink{struct_sincronia_1_1_joystick_a409a1ea5ac18da903dfe8706e1a89ab6}{axes}}.size() == axesCount);}
\DoxyCodeLine{128 }
\DoxyCodeLine{129             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} axesId = 0; axesId < axesCount; ++axesId)}
\DoxyCodeLine{130             \{}
\DoxyCodeLine{131                 joystick.\mbox{\hyperlink{struct_sincronia_1_1_joystick_a409a1ea5ac18da903dfe8706e1a89ab6}{axes}}[axesId] = axes[axesId];}
\DoxyCodeLine{132             \}}
\DoxyCodeLine{133         \}}
\DoxyCodeLine{134     \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{139     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespace_sincronia_ad8b8106393178a2079515dc692cadb90}{setJoystickCallBack}}() \{}
\DoxyCodeLine{140         glfwSetJoystickCallback(\mbox{\hyperlink{namespace_sincronia_ac335102050ee81f0d5348c03f924a5b6}{joystick\_callback}});}
\DoxyCodeLine{141     \}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143 \}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 }

\end{DoxyCode}
